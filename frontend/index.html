<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nature's Diet Executive Analytics</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="backdrop"></div>
  <main class="app-shell">
    <header class="hero">
      <div>
        <p class="eyebrow">Nature's Diet</p>
        <h1>Executive Marketing Dashboard</h1>
        <p class="subtitle">Live mock analytics with persistent run history, drift signals, and operator guidance.</p>
      </div>
      <div class="hero-actions">
        <span id="refreshStamp" class="refresh-stamp">Not loaded yet</span>
        <button id="refreshButton" class="btn btn-secondary">Refresh Data</button>
      </div>
    </header>

    <section class="controls card">
      <h2>Run Controls</h2>
      <div class="control-grid">
        <label>Profile ID
          <input id="profileId" type="text" value="marketing_default" />
        </label>
        <label>Start Date
          <input id="startDate" type="date" value="2026-02-01" />
        </label>
        <label>End Date
          <input id="endDate" type="date" value="2026-02-07" />
        </label>
        <label>Campaign Filter
          <input id="campaignFilter" type="text" placeholder="Optional" />
        </label>
        <label>Ad Group Filter
          <input id="adGroupFilter" type="text" placeholder="Optional" />
        </label>
        <label>Seed
          <input id="seed" type="number" placeholder="Optional deterministic seed" />
        </label>
        <label>Compare Window (runs)
          <input id="compareWindowRuns" type="number" min="1" value="1" />
        </label>
        <label>Target ROAS
          <input id="targetRoas" type="number" step="0.01" value="6.00" />
        </label>
        <label>Monthly Revenue Target
          <input id="monthlyRevenueTarget" type="number" step="0.01" value="3000" />
        </label>
      </div>
      <div class="control-actions">
        <button id="runButton" class="btn btn-primary">Generate New Analytics Run</button>
        <label class="toggle-wrap">
          <input id="includeNarratives" type="checkbox" checked />
          Include Narratives
        </label>
      </div>
      <div id="jobStatus" class="job-status">Ready.</div>
    </section>

    <section class="card">
      <div class="panel-head">
        <h2>Text Workflow Studio</h2>
        <div class="studio-actions">
          <button id="loadTextTemplatesButton" class="btn btn-secondary">Load Templates</button>
          <button id="runTextWorkflowButton" class="btn btn-primary">Run Text Workflow</button>
          <button id="textExportPacketButton" class="btn btn-secondary" disabled>Export Text Packet</button>
        </div>
      </div>
      <div class="text-workflow-grid">
        <label>Campaign Spine ID
          <input id="textCampaignSpineId" type="text" value="spine.default.v1" />
        </label>
        <label>Workflow Template
          <select id="textTemplateSelect"></select>
        </label>
        <label>Variant Count (ad variants)
          <input id="textVariantCount" type="number" min="1" max="30" value="12" />
        </label>
        <label>Route Policy
          <select id="textRoutePolicy">
            <option value="economy">Economy</option>
            <option value="balanced" selected>Balanced</option>
            <option value="quality">Quality</option>
          </select>
        </label>
        <label>Product Name
          <input id="textProductName" type="text" value="Nature's Diet Raw Mix" />
        </label>
        <label>Offer Summary
          <input id="textOfferSummary" type="text" value="Save 20% on first order" />
        </label>
        <label>Audience Segments (comma separated)
          <input id="textAudienceSegments" type="text" value="new puppy owners,sensitive stomach" />
        </label>
        <label>Positioning Statement
          <input id="textPositioningStatement" type="text" value="Raw-first nutrition with practical prep" />
        </label>
        <label>Message Big Idea
          <input id="textBigIdea" type="text" value="Fresh confidence in every bowl" />
        </label>
        <label>Primary Proof Claim
          <input id="textProofClaim" type="text" value="high digestibility blend" />
        </label>
      </div>
      <div class="control-actions">
        <label class="toggle-wrap">
          <input id="textIncludeEvidence" type="checkbox" checked />
          Include Evidence Ref
        </label>
        <label class="toggle-wrap">
          <input id="textPaidCallsAllowed" type="checkbox" />
          Allow Paid Calls (subject to hard cap)
        </label>
      </div>
      <div id="textWorkflowStatus" class="job-status">Text workflow ready.</div>
      <div id="textBudgetSummary" class="narrative-item"></div>
      <div id="textTemplateSummary" class="narrative-item">Load templates to view graph and workflow metadata.</div>
    </section>

    <section class="kpi-grid" id="kpiGrid"></section>

    <section class="content-grid">
      <article class="card panel-wide">
        <h2>Text Workflow Gate</h2>
        <div id="textWorkflowGatePanel" class="publish-gate-panel"></div>
      </article>

      <article class="card panel-wide">
        <h2>Text Workflow Node Trace</h2>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Node</th>
                <th>Role</th>
                <th>Provider</th>
                <th>Model</th>
                <th>Input Tokens</th>
                <th>Output Tokens</th>
                <th>Est. Cost</th>
              </tr>
            </thead>
            <tbody id="textWorkflowTraceBody"></tbody>
          </table>
        </div>
      </article>

      <article class="card panel">
        <h2>Generated Sections</h2>
        <div id="textWorkflowSections" class="narrative-list"></div>
      </article>

      <article class="card panel">
        <h2>Critique Findings</h2>
        <ul id="textWorkflowFindings" class="signal-list"></ul>
      </article>

      <article class="card panel-wide">
        <div class="panel-head">
          <h2>Period-Over-Period Deltas</h2>
          <span id="runIdBadge" class="pill">Run: n/a</span>
        </div>
        <canvas id="deltaChart" height="120"></canvas>
      </article>

      <article class="card panel-wide">
        <h2>Scale vs Efficiency</h2>
        <canvas id="channelMixChart" height="120"></canvas>
      </article>

      <article class="card panel">
        <h2>Quality Controls</h2>
        <ul id="qualityList" class="signal-list"></ul>
      </article>

      <article class="card panel">
        <h2>Data Quality Scorecard</h2>
        <div id="dataQualityPanel" class="data-quality-panel"></div>
      </article>

      <article class="card panel">
        <h2>Drift & Anomaly Flags</h2>
        <ul id="driftList" class="signal-list"></ul>
      </article>

      <article class="card panel-wide">
        <h2>Funnel Leakage</h2>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Stage</th>
                <th>Volume</th>
                <th>Conv. From Prev</th>
              </tr>
            </thead>
            <tbody id="funnelTableBody"></tbody>
          </table>
        </div>
      </article>

      <article class="card panel-wide">
        <h2>Campaign Performance</h2>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Campaign</th>
                <th>Impressions</th>
                <th>Clicks</th>
                <th>Spend</th>
                <th>CTR</th>
                <th>ROAS</th>
              </tr>
            </thead>
            <tbody id="campaignTableBody"></tbody>
          </table>
        </div>
      </article>

      <article class="card panel-wide">
        <h2>Wix Storefront Behavior</h2>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Segment</th>
                <th>Template/Product</th>
                <th>Sessions</th>
                <th>Add-To-Cart</th>
                <th>Purchase Rate</th>
                <th>AOV</th>
              </tr>
            </thead>
            <tbody id="storefrontTableBody"></tbody>
          </table>
        </div>
      </article>

      <article class="card panel-wide">
        <h2>Forecast & Pacing</h2>
        <div id="forecastPanel" class="forecast-panel"></div>
      </article>

      <article class="card panel-wide">
        <div class="panel-head">
          <h2>Publish & Export Gate</h2>
          <button id="exportPacketButton" class="btn btn-secondary" disabled>Export Packet</button>
        </div>
        <div id="publishGatePanel" class="publish-gate-panel"></div>
      </article>

      <article class="card panel-wide">
        <h2>Governance Decision Feed</h2>
        <div id="decisionFeedList" class="decision-feed-list"></div>
      </article>

      <article class="card panel">
        <h2>Operator Narrative</h2>
        <div id="narrativeList" class="narrative-list"></div>
      </article>

      <article class="card panel">
        <h2>Run History</h2>
        <div id="historyList" class="history-list"></div>
      </article>
    </section>
  </main>

  <script src="./node_modules/chart.js/dist/chart.umd.js"></script>
  <script type="module" src="main.js"></script>
</body>
</html>

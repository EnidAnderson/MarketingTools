{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Review Artifact",
  "type": "object",
  "required": [
    "run_id",
    "artifact_id",
    "mode_label",
    "confidence_label",
    "prompt_version",
    "model_version",
    "source_input_hash",
    "editor_log",
    "approval_timestamp_utc",
    "evidence_caveat_map",
    "provenance_bundle",
    "white_lexicon_version",
    "bounded_claim_class",
    "prohibited_implication_scan",
    "ws_fail_state_checks",
    "superseded_ids"
  ],
  "properties": {
    "run_id": {"type": "string", "minLength": 1},
    "artifact_id": {"type": "string", "minLength": 1},
    "mode_label": {"type": "string", "enum": ["explore", "draft", "approved"]},
    "confidence_label": {"type": "string", "enum": ["low", "medium", "high"]},
    "prompt_version": {"type": "string", "minLength": 1},
    "model_version": {"type": "string", "minLength": 1},
    "source_input_hash": {"type": "string", "minLength": 8},
    "editor_log": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["editor", "timestamp_utc", "change_note"],
        "properties": {
          "editor": {"type": "string", "minLength": 1},
          "timestamp_utc": {"type": "string", "format": "date-time"},
          "change_note": {"type": "string", "minLength": 1}
        },
        "additionalProperties": false
      }
    },
    "approval_timestamp_utc": {"type": "string", "format": "date-time"},
    "evidence_caveat_map": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["claim_id", "evidence_ref", "caveat"],
        "properties": {
          "claim_id": {"type": "string", "minLength": 1},
          "evidence_ref": {"type": "string", "minLength": 1},
          "caveat": {"type": "string", "minLength": 1}
        },
        "additionalProperties": false
      }
    },
    "provenance_bundle": {
      "type": "object",
      "required": ["prompt_version", "model_version", "source_input_hash", "editor_log_ref"],
      "properties": {
        "prompt_version": {"type": "string", "minLength": 1},
        "model_version": {"type": "string", "minLength": 1},
        "source_input_hash": {"type": "string", "minLength": 8},
        "editor_log_ref": {"type": "string", "minLength": 1}
      },
      "additionalProperties": false
    },
    "white_lexicon_version": {"type": "string", "pattern": "^v[0-9]+$"},
    "bounded_claim_class": {"type": "string", "enum": ["educational_qualified", "promotional_qualified"]},
    "prohibited_implication_scan": {
      "type": "object",
      "required": ["hits"],
      "properties": {
        "hits": {"type": "integer", "minimum": 0}
      },
      "additionalProperties": false
    },
    "lexical_hard_fail_count": {"type": "integer", "minimum": 0},
    "ws_fail_state_checks": {
      "type": "object",
      "required": ["WS-FS-001", "WS-FS-002", "WS-FS-003"],
      "properties": {
        "WS-FS-001": {"type": "boolean"},
        "WS-FS-002": {"type": "boolean"},
        "WS-FS-003": {"type": "boolean"}
      },
      "additionalProperties": false
    },
    "superseded_ids": {"type": "array", "items": {"type": "string"}}
  },
  "additionalProperties": false
}
